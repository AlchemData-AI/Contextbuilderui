# How to View the New Golden Queries Feedback Loop Feature

## âœ… Feature is Fully Implemented!

The "New Queries from User Conversations" section has been successfully added to the Golden Queries page.

---

## ğŸ¯ How to Access

### Option 1: Quick Test Button (Easiest)
1. Go to the **Agents Dashboard** (home page)
2. Look for the **"ğŸ§ª Test Golden Queries"** button in the header (next to "Create New Agent")
3. Click it to navigate directly to the Golden Queries page

### Option 2: Through Post-Publish Flow
1. Create a new agent (or edit an existing one)
2. Complete Steps 1-6 of the wizard
3. Click "Publish Agent"
4. On the success screen, click "Configure Relationships"
5. Approve at least one relationship
6. Click "Continue to Golden Queries"
7. You'll see the new section!

### Option 3: Direct URL
Navigate to: `/configure-golden-queries/agent-1`

---

## ğŸ“ What You'll See

### 1. Purple Banner Section
At the top of the page (after AI-generated queries, before metrics), you'll see:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¥ New Queries from User Conversations (3)                  â”‚
â”‚                                                              â”‚
â”‚ These queries were generated by your AI agent during user   â”‚
â”‚ conversations but aren't part of the golden query set yet.  â”‚
â”‚ Review usage patterns and validate to add them to your      â”‚
â”‚ golden set.                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Query Cards (2-column grid)

Each card shows:
- **"From Conversations"** badge (purple)
- **Usage count** badge (e.g., "12 uses")
- **Question** being asked
- **Involved agents** (e.g., Sales Analytics, Inventory Management)
- **Usage stats**:
  - Last Used: "2 hours ago"
  - User Feedback: ğŸ‘ 9  ğŸ‘ 1
- **"View Conversations"** button
- **Expandable SQL query** with "Edit SQL" option
- **Action buttons**: "Dismiss" and "Add to Golden Set"

---

## ğŸ§ª Mock Data Included

### 3 Example Queries:

**Query 1: Product Performance**
- "Show me products with declining sales in the last 3 months"
- 12 uses, 90% positive feedback
- 3 conversation examples

**Query 2: Customer Behavior**
- "What is the average time between customer orders?"
- 8 uses, 100% positive feedback
- 2 conversation examples

**Query 3: Logistics**
- "Show me shipments delayed by more than 3 days"
- 15 uses, 80% positive feedback
- 2 conversation examples

---

## âš¡ Interactive Features

### View Conversations
Click "View Conversations" to see a modal with:
- Usage summary (total uses, success rate, feedback counts)
- All conversations where users asked this query
- Different phrasings of the same question
- AI responses for each conversation

### Edit SQL
1. Click "View SQL Query" to expand
2. Click "Edit SQL" button
3. Modify the SQL in the textarea
4. Click "Save Changes"
5. Then click "Add to Golden Set" (uses your edited SQL)

### Add to Golden Set
1. Review the query
2. Check usage stats (high usage + positive feedback = good candidate)
3. Optionally view conversations
4. Optionally edit SQL
5. Click "Add to Golden Set"
6. Query moves from "New Queries" to "Approved Queries" section

### Dismiss
1. Click "Dismiss" on any query
2. Query is removed from the review list
3. Toast notification confirms dismissal

---

## ğŸ¨ Visual Markers

**Color Coding:**
- ğŸŸ£ **Purple** (`#6366F1`): New queries from conversations
- ğŸ”µ **Teal** (`#00B5B3`): AI-generated queries
- ğŸŸ¢ **Green** (`#00B98E`): Approved queries
- ğŸŸ  **Orange** (`#F79009`): Needs revision

**Badge Types:**
- Purple badge: "From Conversations"
- Outline badge: Usage count
- Green border: Approved queries
- Purple border: New conversation queries

---

## ğŸ“Š Example Workflow

### Scenario: Analyst Reviews New Query

```
Step 1: See new query "Show me products with declining sales"
        â†“
Step 2: Check stats:
        â€¢ 12 uses (good!)
        â€¢ 9 ğŸ‘ / 1 ğŸ‘ (90% success rate - excellent!)
        â€¢ Last used 2 hours ago (active!)
        â†“
Step 3: Click "View 3 Conversations"
        â€¢ Sarah Chen: "Show me products with declining sales..."
        â€¢ Mike Johnson: "Which products are selling less this month?"
        â€¢ Emma Davis: "Show declining product performance"
        (Same intent, different phrasings!)
        â†“
Step 4: Click "View SQL Query"
        â€¢ Review the generated SQL
        â€¢ Notice it's well-structured
        â†“
Step 5: Decision: High usage, positive feedback, good SQL
        â†’ Click "Add to Golden Set"
        â†“
Result: Query now appears in "Approved Queries" section
        Future users asking similar questions get instant,
        validated responses!
```

---

## ğŸ” Where is Everything?

### File Locations:
- **Main Page**: `/pages/ConfigureGoldenQueries.tsx`
- **Route**: `/configure-golden-queries/:agentId`
- **Test Button**: `/pages/AgentsDashboard.tsx` (header)

### Key Code Sections:
- **Interface**: `NewQuery` (lines 60-76)
- **Mock Data**: `NEW_QUERIES_FROM_CONVERSATIONS` (lines 143-248)
- **State**: `newQueries` state variable (line 325)
- **Handlers**: `handleAddNewQueryToGolden`, `handleRejectNewQuery` (lines 419-443)
- **UI Section**: Lines 742-1008

---

## âœ¨ What Makes This Special

### 1. **Real Usage Data**
Unlike traditional golden queries created upfront, these are based on actual user conversations and needs.

### 2. **Data-Driven Validation**
- See exactly how many times a query was used
- View user feedback (thumbs up/down)
- Read actual conversations to understand context

### 3. **Continuous Improvement**
The golden query set grows organically as users interact with the system, creating a feedback loop.

### 4. **Quality Assurance**
Analysts can:
- Review before adding
- Edit SQL if needed
- Dismiss poor queries
- Ensure only validated queries make it to golden set

---

## ğŸš€ Try It Now!

1. Click the **"ğŸ§ª Test Golden Queries"** button on the dashboard
2. Scroll down past the regular golden queries section
3. You'll see the purple "New Queries from User Conversations" section
4. Click around - try viewing conversations, editing SQL, adding to golden set!

---

## ğŸ’¡ Expected Behavior

### When you click "Add to Golden Set":
- âœ… Query disappears from "New Queries" section
- âœ… Query appears in "Approved Queries" section below
- âœ… Toast notification: "Query added to golden set"
- âœ… Counter updates (e.g., "4/5 approved" â†’ "5/5 approved")

### When you click "Dismiss":
- âœ… Query disappears from list
- âœ… Toast notification: "Query dismissed"
- âœ… Counter updates (e.g., "(3)" â†’ "(2)")

### When you click "View Conversations":
- âœ… Modal opens with conversation history
- âœ… Shows usage summary at top
- âœ… Lists all conversations with user names, timestamps, questions, answers

### When you click "Edit SQL":
- âœ… SQL becomes editable in textarea
- âœ… "Save Changes" and "Cancel" buttons appear
- âœ… Can modify the SQL before adding to golden set

---

## ğŸ‰ All Features Working!

- âœ… Purple-themed section for new queries
- âœ… Usage stats (count, last used, feedback)
- âœ… View conversations dialog
- âœ… Editable SQL
- âœ… Add to golden set
- âœ… Dismiss queries
- âœ… Toast notifications
- âœ… Counter updates
- âœ… Mock data with 3 examples
- âœ… Responsive 2-column grid
- âœ… Visual indicators and badges

**Everything is ready to use!** ğŸš€
